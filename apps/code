#!/bin/bash
temp_file=$(mktemp)
code serve-web > "$temp_file" &
sleep 1  # Wait for the process to write to the file (adjust time as needed)
url=$(grep -o 'http\(s\)\?://\(127\.0\.0\.1\|localhost\):[0-9]\+' "$temp_file" | head -1)
surf "$url" &
surf_pid=$!

# Monitor the surf process
while ps -p $surf_pid > /dev/null; do
    sleep 1
done

# If surf exits, kill code serve-web
kill %1  # Assumes code serve-web is the first background job
rm "$temp_file"  # Clean up temporary file

